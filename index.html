<!DOCTYPE html>
<html>
<head>
    
    <title>Manual GeoAR Placement</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    <style>
        .ui-panel {
            position: fixed; top: 10px; left: 50%; transform: translateX(-50%);
            z-index: 100; background: rgba(0,0,0,0.7); color: white; padding: 15px;
            border-radius: 8px; font-family: sans-serif; width: 80%;
        }
        input { width: 100%; margin: 5px 0; padding: 5px; }
        button { width: 100%; padding: 10px; background: #28a745; color: white; border: none; cursor: pointer; }
    </style>
</head>

<body style="margin: 0; overflow: hidden;">

    <div class="ui-panel">
        <label>Tree Latitude:</label>
        <input type="number" id="latInput" step="0.000001" placeholder="e.g. 51.5074">
        <label>Tree Longitude:</label>
        <input type="number" id="lonInput" step="0.000001" placeholder="e.g. -0.1278">
        <button onclick="deployHoles()">PLACE HOLES AROUND TREE</button>
    </div>

    <a-scene embedded vr-mode-ui="enabled: false" arjs="sourceType: webcam; debugUIEnabled: false;">
        <a-camera gps-camera rotation-reader></a-camera>
    </a-scene>

    <script>
        function deployHoles() {
            const treeLat = parseFloat(document.getElementById('latInput').value);
            const treeLon = parseFloat(document.getElementById('lonInput').value);

            if(!treeLat || !treeLon) {
                alert("Please enter valid coordinates!");
                return;
            }

            // Remove old holes if they exist
            document.querySelectorAll('.ar-hole').forEach(el => el.remove());

            // The "Off East" correction variable
            // Your boss said it's slightly off east - adjust this 'correction' as needed
            const eastCorrection = 0.00001; 

            // Create 4 holes around the coordinate you entered
            const positions = [
                { lat: treeLat + 0.00002, lon: treeLon, color: 'red' },    // North
                { lat: treeLat - 0.00002, lon: treeLon, color: 'blue' },   // South
                { lat: treeLat, lon: treeLon + 0.00002 + eastCorrection, color: 'yellow' }, // East
                { lat: treeLat, lon: treeLon - 0.00002, color: 'green' }   // West
            ];

            const scene = document.querySelector('a-scene');

            positions.forEach(pos => {
                const ring = document.createElement('a-ring');
                ring.setAttribute('class', 'ar-hole');
                ring.setAttribute('gps-entity-place', `latitude: ${pos.lat}; longitude: ${pos.lon};`);
                ring.setAttribute('color', pos.color);
                ring.setAttribute('radius-inner', '0.3');
                ring.setAttribute('radius-outer', '0.5');
                ring.setAttribute('rotation', '-90 0 0');
                
                // Add a text label so you know which is which
                const text = document.createElement('a-text');
                text.setAttribute('value', pos.color);
                text.setAttribute('look-at', '[gps-camera]');
                text.setAttribute('scale', '10 10 10');
                text.setAttribute('align', 'center');
                text.setAttribute('position', '0 1 0');
                ring.appendChild(text);

                scene.appendChild(ring);
            });

            alert("Holes deployed at manual coordinates. Look around!");
        }
    </script>
</body>
</html>